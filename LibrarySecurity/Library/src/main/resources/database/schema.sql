drop table if exists comments;
drop table if exists books;
drop table if exists authors;
drop table if exists genres;
drop table if exists roles;
drop table if exists users;

create table authors
(
    id int8 generated by default as identity
    (START WITH 4),
    surname varchar(255),
    primary key (id)
);

create table genres
(
    id int8 generated by default as identity
    (START WITH 3),
    type varchar(255),
    primary key (id)
);

create table books
(
    id int8 generated by default as identity
    (START WITH 4),
    tittle varchar(255),
    author_id int8,
    genre_id int8,
    primary key (id)
);

create table comments
(
    id int8 generated by default as identity,
    text varchar(255),
    book_id int8,
    user_id int8,
    primary key (id)
);

create table users
(
    id int8 generated by default as identity,
    username varchar(255),
    password varchar(255),
    primary key (id)
);

create table roles
(
    user_id bigint,
    roles varchar(255)
);

alter table if exists books
add constraint FK_author
foreign key (author_id) references authors;

alter table if exists books
add constraint FK_genre
foreign key (genre_id) references genres;

alter table if exists comments
add constraint FK_book
foreign key (book_id) references books;

alter table if exists comments
add constraint FK_user
foreign key (user_id) references users;

alter table if exists roles
add constraint FK_role
foreign key (user_id) references users;
